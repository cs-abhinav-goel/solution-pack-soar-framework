{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Notify Ack SLA Violation",
    "aliasName": null,
    "tag": "#Subroutine #system",
    "description": "Notify user for Acknowledgement SLA violation",
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "severity",
        "incident_IRI",
        "incident_createdDate"
    ],
    "synchronous": false,
    "lastModifyDate": 1645126827,
    "collection": "\/api\/3\/workflow_collections\/e3b9c59f-d600-4ad2-b256-ed1452c64aef",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/af000f04-a4a6-47e0-b11d-2b096f1b9e34",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Compute Elapsed Time In Minutes",
            "description": "",
            "arguments": {
                "elapsed_time": "{{ ((arrow.utcnow() - arrow.get(vars.input.params['incident_createdDate'])).total_seconds()\/60) | int }}"
            },
            "status": null,
            "top": "190",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "1f9b9c84-142e-4275-913e-4e40e42429b5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set SLA Violated Flag",
            "description": null,
            "arguments": {
                "resource": {
                    "slaState": {
                        "id": 9387,
                        "@id": "\/api\/3\/picklists\/0083c60d-08b3-4e94-92ab-7f87ecbe96af",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#d61a1a",
                        "display": "Missed",
                        "listName": "\/api\/3\/picklist_names\/a322d776-a9de-4416-bacc-14f7459cefd7",
                        "itemValue": "Missed",
                        "orderIndex": 1
                    },
                    "slaPercentage": 100
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params['incident_IRI']}}",
                "collectionType": "\/api\/3\/incidents",
                "step_variables": []
            },
            "status": null,
            "top": "609",
            "left": "2440",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "bc3347e2-42a9-45f0-a374-7e94f31c949c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": {
                            "severity": "{{ vars.severity }}",
                            "incident_IRI": "{{ vars.incident_IRI }}",
                            "incident_createdDate": "{{ vars.incident_createdDate }}"
                        }
                    }
                }
            },
            "status": null,
            "top": "190",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "af000f04-a4a6-47e0-b11d-2b096f1b9e34"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set 50 Percent SLA Violation",
            "description": null,
            "arguments": {
                "resource": {
                    "slaPercentage": 50
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params['incident_IRI']}}",
                "collectionType": "\/api\/3\/incidents",
                "step_variables": []
            },
            "status": null,
            "top": "180",
            "left": "2540",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "45e361ce-3023-4d51-a904-cc2f16f3f61d"
        },
        {
            "@type": "WorkflowStep",
            "name": "No SLA Fetched",
            "description": null,
            "arguments": {
                "params": {
                    "msg": "No SLA Fetched"
                },
                "version": "2.1.0",
                "connector": "cyops_utilities",
                "operation": "raise_exception",
                "operationTitle": "Utils: Raise Exception",
                "step_variables": []
            },
            "status": null,
            "top": "110",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "42621f5e-7620-4abc-9913-50caf9518b99"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set 75 Percent SLA Violation",
            "description": null,
            "arguments": {
                "resource": {
                    "slaPercentage": 75
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params['incident_IRI']}}",
                "collectionType": "\/api\/3\/incidents",
                "step_variables": []
            },
            "status": null,
            "top": "507",
            "left": "2530",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "d03fb1d1-7490-463b-a5ca-ed9e709de232"
        },
        {
            "@type": "WorkflowStep",
            "name": "Percent Lapsed Time",
            "description": "Compute Percentage Elapsed Time Passed For P1",
            "arguments": {
                "time_elapsed_percentage": "{{((vars.elapsed_time \/ vars.ack_sla_eta) * 100) | int}}"
            },
            "status": null,
            "top": "270",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "df5f5b46-6e24-4c39-9971-284e2184fbc8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Alert User for SLA Violation",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "< 50%",
                        "step_iri": "\/api\/3\/workflow_steps\/fb596c37-689a-4fe1-882c-0ff46e11ddcd",
                        "condition": "{{ vars.time_elapsed_percentage < 50 }}"
                    },
                    {
                        "option": ">= 50%",
                        "step_iri": "\/api\/3\/workflow_steps\/45e361ce-3023-4d51-a904-cc2f16f3f61d",
                        "condition": "{{ vars.time_elapsed_percentage >=50 and  vars.time_elapsed_percentage < 75 }}"
                    },
                    {
                        "option": ">= 75%",
                        "step_iri": "\/api\/3\/workflow_steps\/d03fb1d1-7490-463b-a5ca-ed9e709de232",
                        "condition": "{{ vars.time_elapsed_percentage >=75 and  vars.time_elapsed_percentage < 100 }}"
                    },
                    {
                        "option": ">= 100%",
                        "step_iri": "\/api\/3\/workflow_steps\/bc3347e2-42a9-45f0-a374-7e94f31c949c",
                        "condition": "{{ vars.time_elapsed_percentage >= 100 }}"
                    }
                ]
            },
            "status": null,
            "top": "270",
            "left": "2075",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "67fcd38c-8bcd-444b-9f0e-5461fa92c251"
        },
        {
            "@type": "WorkflowStep",
            "name": "Terminate Playbook Percentage in safe Range",
            "description": null,
            "arguments": {
                "name": "CyOPs Utilities",
                "params": [],
                "version": "2.1.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "9",
            "left": "2453",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "fb596c37-689a-4fe1-882c-0ff46e11ddcd"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch SLA Details",
            "description": null,
            "arguments": {
                "arguments": {
                    "inc_severity": "{{vars.input.params.severity}}"
                },
                "step_variables": {
                    "slaResult": "{{vars.result}}"
                },
                "workflowReference": "\/api\/3\/workflows\/4c4d8e7e-de26-4afa-8110-50c5a555b2ec"
            },
            "status": null,
            "top": "190",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "ac5a0ff8-03f6-43dd-99f5-0c7d7b19a6c2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set SLA details",
            "description": null,
            "arguments": {
                "ack_sla_eta": "{{vars.slaResult.sla_time_list[0]}}"
            },
            "status": null,
            "top": "270",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "346e5e19-99f9-4991-b8ac-e65dc929d99e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Verify SLA Details",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Not Fetched",
                        "step_iri": "\/api\/3\/workflow_steps\/42621f5e-7620-4abc-9913-50caf9518b99",
                        "condition": "{{ vars.slaResult | length != 1 }}"
                    },
                    {
                        "option": "Fetched",
                        "step_iri": "\/api\/3\/workflow_steps\/346e5e19-99f9-4991-b8ac-e65dc929d99e",
                        "condition": "{{ vars.slaResult | length == 1 }}"
                    }
                ]
            },
            "status": null,
            "top": "190",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "fd5752b2-bf35-4fb7-b877-23eb05394833"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Compute Percentage Elapsed Time Passed For P1 -> Alert User for SLA Violation",
            "targetStep": "\/api\/3\/workflow_steps\/67fcd38c-8bcd-444b-9f0e-5461fa92c251",
            "sourceStep": "\/api\/3\/workflow_steps\/df5f5b46-6e24-4c39-9971-284e2184fbc8",
            "label": null,
            "isExecuted": false,
            "uuid": "dc267e8d-3467-4298-8947-5cbf347345f6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch SLA Details -> Verify SLA Details",
            "targetStep": "\/api\/3\/workflow_steps\/fd5752b2-bf35-4fb7-b877-23eb05394833",
            "sourceStep": "\/api\/3\/workflow_steps\/ac5a0ff8-03f6-43dd-99f5-0c7d7b19a6c2",
            "label": null,
            "isExecuted": false,
            "uuid": "8dc1749d-a713-4b4c-b383-95e36e02d6c1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Alert User for SLA Violation -> Copy  of Update for 75 Percent Violation",
            "targetStep": "\/api\/3\/workflow_steps\/bc3347e2-42a9-45f0-a374-7e94f31c949c",
            "sourceStep": "\/api\/3\/workflow_steps\/67fcd38c-8bcd-444b-9f0e-5461fa92c251",
            "label": ">= 100%",
            "isExecuted": false,
            "uuid": "70c7ecbb-6b3b-42b3-98ee-a3f5320e878b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set SLA details -> P1 Percent Lapsed Time",
            "targetStep": "\/api\/3\/workflow_steps\/df5f5b46-6e24-4c39-9971-284e2184fbc8",
            "sourceStep": "\/api\/3\/workflow_steps\/346e5e19-99f9-4991-b8ac-e65dc929d99e",
            "label": null,
            "isExecuted": false,
            "uuid": "78053eaa-14db-4720-a26e-1a7a431f4ea4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Verify SLA Details -> Set SLA details",
            "targetStep": "\/api\/3\/workflow_steps\/346e5e19-99f9-4991-b8ac-e65dc929d99e",
            "sourceStep": "\/api\/3\/workflow_steps\/fd5752b2-bf35-4fb7-b877-23eb05394833",
            "label": "Fetched",
            "isExecuted": false,
            "uuid": "d147fda7-4936-440c-9f1f-041e02a7b172"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Alert User for SLA Violation -> Update for 75 Percent Violation",
            "targetStep": "\/api\/3\/workflow_steps\/d03fb1d1-7490-463b-a5ca-ed9e709de232",
            "sourceStep": "\/api\/3\/workflow_steps\/67fcd38c-8bcd-444b-9f0e-5461fa92c251",
            "label": ">= 75%",
            "isExecuted": false,
            "uuid": "9e79bdba-8226-4e7b-b8db-2cd3f2f4869a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Verify SLA Details -> No SLA Fetched",
            "targetStep": "\/api\/3\/workflow_steps\/42621f5e-7620-4abc-9913-50caf9518b99",
            "sourceStep": "\/api\/3\/workflow_steps\/fd5752b2-bf35-4fb7-b877-23eb05394833",
            "label": "Not Fetched",
            "isExecuted": false,
            "uuid": "6a96e2ef-6c15-4c00-be29-1988e3e4611a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Alert User for SLA Violation -> Terminate Playbook Percentage in safe Range",
            "targetStep": "\/api\/3\/workflow_steps\/fb596c37-689a-4fe1-882c-0ff46e11ddcd",
            "sourceStep": "\/api\/3\/workflow_steps\/67fcd38c-8bcd-444b-9f0e-5461fa92c251",
            "label": "< 50%",
            "isExecuted": false,
            "uuid": "35db367a-1a10-4166-bd60-bf8ba0bb00c5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Elapsed Time In Minutes -> Fetch SLA Details",
            "targetStep": "\/api\/3\/workflow_steps\/ac5a0ff8-03f6-43dd-99f5-0c7d7b19a6c2",
            "sourceStep": "\/api\/3\/workflow_steps\/1f9b9c84-142e-4275-913e-4e40e42429b5",
            "label": null,
            "isExecuted": false,
            "uuid": "c3f2dda6-2713-4faf-9a1b-603306111944"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Compute Elapsed Time In Minutes",
            "targetStep": "\/api\/3\/workflow_steps\/1f9b9c84-142e-4275-913e-4e40e42429b5",
            "sourceStep": "\/api\/3\/workflow_steps\/af000f04-a4a6-47e0-b11d-2b096f1b9e34",
            "label": null,
            "isExecuted": false,
            "uuid": "2315a094-2276-48fc-98f2-db9c2020da41"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Alert User for SLA Violation -> Update for 50 Percent Violation",
            "targetStep": "\/api\/3\/workflow_steps\/45e361ce-3023-4d51-a904-cc2f16f3f61d",
            "sourceStep": "\/api\/3\/workflow_steps\/67fcd38c-8bcd-444b-9f0e-5461fa92c251",
            "label": ">= 50%",
            "isExecuted": false,
            "uuid": "f541d871-e3bb-4a7c-9ad3-800079f11e93"
        }
    ],
    "priority": null,
    "uuid": "c293c365-bd34-4eb0-b5c5-512fc5a5297c",
    "recordTags": [
        "system",
        "SLA",
        "Subroutine",
        "FSRSolutionPack",
        "sOARFramework-1.0.0"
    ],
    "id": "206",
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1645124460.454444,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1645126827.606972,
    "owners": [],
    "isPrivate": false,
    "deletedAt": null
}